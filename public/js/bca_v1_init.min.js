/*! Built for bca_v1 2013-12-01 */
var BCA,UI,WS;BCA||(BCA={}),UI=function(){function a(){}return a.prototype.container="container",a.prototype.mixins={hello:null},a.prototype.helpers={hello:function(){}},a.prototype.make_cal=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(j="",r="",h=1,p="",d=new Date,c=d.getMonth(),e=d.getDate(),s=d.getFullYear(),m=a+1,k=a-1,1===a&&(r=s%100!==0&&s%4===0||s%400===0?29:28),i=["Jan","Feb","March","April","May","June","July","Aug","Sept","Oct","Nov","Dec"],g=["Sunday","Monday","Tuesday","Wednesday","Thrusday","Friday","Saturday"],q=["31",""+r,"31","30","31","30","31","31","30","31","30","31"],l=new Date(m+" 1 ,"+s),n=l.getDay(),o=n,f=q[a];n>0;)j+="<td class='premonth'></td>",n--;for(;f>=h;)o>6&&(o=0,j+="</tr><tr>"),j+=h===e&&a===c?"<td class='currentday c_date d_"+(a+1)+"_"+h+"'><div>"+h+"</div></td>":"<td class='currentmonth c_date d_"+(a+1)+"_"+h+"'><div>"+h+"</div></td>",o++,h++;return b="<table class='calendar'> <tr class='header'><th colspan='7'><i class='prev_month fa fa-arrow-circle-o-left'></i>"+i[a]+" "+s+"<i class='next_month fa fa-arrow-circle-o-right'></i></th></tr>",b+="<tr class='weekdays'>  <td>Sun</td>  <td>Mon</td> <td>Tues</td> <td>Wed</td> <td>Thurs</td> <td>Fri</td> <td>Sat</td> </tr>",b+="<tr>",b+=j,b+="</tr></table>"},a.prototype.gen_user_name=function(){var a;return a=[["artless","bawdy","beslubbering","bootless","churlish","cockered","clouted","craven","currish","dankish","dissembling","droning","errant","fawning","fobbing","froward","frothy","gleeking","goatish","gorbellied","impertinent","infectious","jarring","loggerheaded","lumpish","mammering","mangled","mewling","paunchy","pribbling","puking","puny","qualling","rank","reeky","roguish","ruttish","saucy","spleeny","spongy","surly","tottering","unmuzzled","vain","venomed","villainous","warped","wayward","weedy","yeasty"],["base-court","bat-fowling","beef-witted","beetle-headed","boil-brained","clapper-clawed","clay-brained","common-kissing","crook-pated","dismal-dreaming","dizzy-eyed","doghearted","dread-bolted","earth-vexing","elf-skinned","fat-kidneyed","fen-sucked","flap-mouthed","fly-bitten","folly-fallen","fool-born","full-gorged","guts-griping","half-faced","hasty-witted","hedge-born","hell-hated","idle-headed","ill-breeding","ill-nurtured","knotty-pated","milk-livered","motley-minded","onion-eyed","plume-plucked","pottle-deep","pox-marked","reeling-ripe","rough-hewn","rude-growing","rump-fed","shard-borne","sheep-biting","spur-galled","swag-bellied","tardy-gaited","tickle-brained","toad-spotted","unchin-snouted","weather-bitten"],["apple-john","baggage","barnacle","bladder","boar-pig","bugbear","bum-bailey","canker-blossom","clack-dish","clotpole","coxcomb","codpiece","death-token","dewberry","flap-dragon","flax-wench","flirt-gill","foot-licker","fustilarian","giglet","gudgeon","haggard","harpy","hedge-pig","horn-beast","hugger-mugger","joithead","lewdster","lout","maggot-pie","malt-worm","mammet","measle","minnow","miscreant","moldwarp","mumble-news","nut-hook","pigeon-egg","pignut","puttock","pumpion","ratsbane","scut","skainsmate","strumpet","varlot","vassal","whey-face","wagtail"]],a[0][Math.floor(Math.random()*a[0].length)]+" "+a[1][Math.floor(Math.random()*a[1].length)]+" "+a[2][Math.floor(Math.random()*a[2].length)]},a.prototype.str_to_int=function(a){var b;return b=a.match(/\d+/),parseInt(b[0],10)},a.prototype.key_return=function(a,b){return $("#"+a).unbind().keypress(function(a){var c;return c=a.keyCode||a.which,13===c?(b(),!1):void 0})},a.prototype.schedule=function(a){return setTimeout(a,0)},a.prototype.render_append=function(a,b,c,d){return a||(a=$("#"+this.container)),"string"==typeof a&&(a="#"===a[0]||"."===a[0]?$(a):$("#"+a)),c.mixins=this.mixins,c.helpers=this.helpers,a.append(bca_templates["jade/"+b](c)),"function"==typeof d?this.schedule(function(){return d(a)}):void 0},a.prototype.render_rewrite=function(a,b,c,d){return a||(a=$("#"+this.container)),"string"==typeof a&&(a="#"===a[0]||"."===a[0]?$(a):$("#"+a)),c.mixins=this.mixins,c.helpers=this.helpers,a.html(bca_templates["jade/"+b](c)),"function"==typeof d?this.schedule(function(){return d(a)}):void 0},a.prototype.convert_to_slug=function(a){return a.toLowerCase().replace(/\s/g,"_").replace(/[^\w-]+/g,"")},a.prototype.gen_id=function(){return Math.random().toString(36).substring(6)},a.prototype.make_img_upload=function(a,b){return this.schedule(function(){return $("#"+a).dropzone({url:"/save_image",maxFilesize:2,uploadMultiple:!1,createImageThumbnails:!1,acceptedMimeTypes:"image/*",init:function(){return this.on("selectedfiles",function(){}),this.on("dragover",function(){return $("#"+a).css({"border-color":"green"})}),this.on("dragleave",function(){return $("#"+a).css({"border-color":"#CCC"})}),this.on("sending",function(){return $("#"+a).text("Uploading..")}),this.on("uploadprogress",function(b,c){return console.log(c),$("#"+a).html("Uploading.. "+(c+"").substring(0,5)+"%")}),this.on("success",function(c,d){return $("#"+a).css({"background-image":"url("+d.filename+")"}),$("#"+a).text(""),b?b(d.filename):void 0}),this.on("error",function(b,c){return $("#"+a).html(c)})}})})},a.prototype.make_jq_img_upload=function(a,b,c,d){return $("#"+a).fileupload({dataType:"json",url:"/save_image",disableImageResize:/Android(?!.*Chrome)|Opera/.test(window.navigator&&navigator.userAgent),imageMaxWidth:800,imageMaxHeight:800,progressall:function(a,b){var d;return d=parseInt(b.loaded/b.total*100,10),$("#"+c).text(d+"%")},done:function(a,b){return $("#"+c).text("Done!"),console.log(b.result.filename),d?d(b.result.filename):void 0}})},a}(),WS=function(){function a(){}return a.prototype.ajax_cache_default_expire=5e3,a.prototype.ajax_cache={},a.prototype.write_to_ajax_cache=function(a,b,c,d){return console.log("caching "+(a+"_"+b)),this.ajax_cache[a+"_"+b]={data:c,time:new Date,duration:this.ajax_cache_default_expire},null!=d?this.ajax_cache[a+"_"+b].duration=d:void 0},a.prototype.get_from_ajax_cache=function(a,b){return null!=this.ajax_cache[a+"_"+b]?new Date-this.ajax_cache[a+"_"+b].time>this.ajax_cache[a+"_"+b].duration?(delete this.ajax_cache[a+"_"+b],console.log("cache expired "+a+" "+b),!1):(console.log("cache hit "+a+" "+b),this.ajax_cache[a+"_"+b].data):(console.log("cache miss "+a+" "+b),!1)},a.prototype.root_url=function(){return document.location.protocol+"//"+document.location.host},a.prototype.get=function(a,b,c){var d,e;return NProgress.start(),e=this,d=e.get_from_ajax_cache(a,a),d!==!1?(NProgress.done(),b(d),void 0):$.ajax({type:"GET",url:e.root_url()+"/"+a,dataType:"json",contentType:"application/json",success:function(d){return e.write_to_ajax_cache(a,a,d,c),NProgress.done(),null!=d.error?BCA.ui.flash_message(d.error):b(d)},error:function(a,b,c){return console.error(c)}})},a.prototype.post=function(a,b,c,d){var e,f;return NProgress.start(),f=this,this.clear_data(b),e=f.get_from_ajax_cache(a,a),e!==!1?(NProgress.done(),c(e),void 0):$.ajax({type:"POST",url:f.root_url()+"/"+a,data:JSON.stringify(b),dataType:"json",contentType:"application/json",success:function(b){return null!=d&&(console.log("Cachine post request.."),f.write_to_ajax_cache(a,a,b,d)),NProgress.done(),null!=b.error?BCA.ui.flash_message(b.error):c(b)},error:function(a,b,c){return console.error(c)}})},a.prototype.find=function(a,b,c){var d,e;return NProgress.start(),e=this,d=e.get_from_ajax_cache(a.model_name,a.id),d!==!1?(NProgress.done(),b(d),void 0):$.ajax({type:"GET",url:e.root_url()+"/"+a.model_name+"/"+a.id+"?"+a.params,dataType:"json",contentType:"application/json",success:function(d){return e.write_to_ajax_cache(a.model_name,a.id,d,c),NProgress.done(),null!=d.error?BCA.ui.flash_message(d.error):b(d)},error:function(a,b,c){return console.error(c)}})},a.prototype["delete"]=function(a,b){var c;return NProgress.start(),c=this,this.clear_data(a.data),$.ajax({type:"DELETE",url:c.root_url()+"/"+a.model_name+"/"+a.id+"?"+a.params,dataType:"json",contentType:"application/json",success:function(a){return NProgress.done(),null!=a.error?BCA.ui.flash_message(a.error):b(a)},error:function(a,b,c){return console.error(c)}})},a.prototype.update=function(a,b){var c;return NProgress.start(),c=this,this.clear_data(a.data),$.ajax({type:"PUT",url:c.root_url()+"/"+a.model_name+"/"+a.id,data:JSON.stringify(a.data),dataType:"json",contentType:"application/json",success:function(a){return NProgress.done(),null!=a.error?BCA.ui.flash_message(a.error):b(a)},error:function(a,b,c){return console.error(c)}})},a.prototype.create=function(a,b){var c;return NProgress.start(),c=this,this.clear_data(a.data),$.ajax({type:"POST",url:c.root_url()+"/"+a.model_name,dataType:"json",contentType:"application/json",data:JSON.stringify(a.data),success:function(a){return NProgress.done(),null!=a.error?BCA.ui.flash_message(a.error):b(a)},error:function(a,b,c){return console.error(c)}})},a.prototype.set_cookie=function(a,b,c){var d,e;return c?(d=new Date,d.setTime(d.getTime()+24*c*60*60*1e3),e="; expires="+d.toGMTString()):e="",document.cookie=a+"="+b+e+"; path=/"},a.prototype.get_cookie=function(a){var b,c,d,e;for(e=a+"=",c=document.cookie.split(";"),d=0;d<c.length;){for(b=c[d];" "===b.charAt(0);)b=b.substring(1,b.length);if(0===b.indexOf(e))return b.substring(e.length,b.length);d++}return null},a.prototype.clear_data=function(a){var b,c,d,e,f,g,h,i;i=[];for(c in a){f=a[c],"_"===c[0]&&delete a[c];for(d in f)g=f[d],"_"===d[0]&&delete f[d];null!=f?i.push(function(){var a,c,d;for(d=[],a=0,c=f.length;c>a;a++)b=f[a],d.push(function(){var a;a=[];for(e in b)h=b[e],"_"===e[0]?a.push(delete b[e]):a.push(void 0);return a}());return d}()):i.push(void 0)}return i},a}(),BCA.ui=new UI,BCA.ws=new WS;